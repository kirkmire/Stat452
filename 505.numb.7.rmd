---
title: "FORS 505"
author: "Colin Kirkmire"
date: "April 28, 2016"
output: word_document
---

(4) Compute a 90% CI for the number of TPHA on the whole tract
```{r setup, include=FALSE}

A_1<-c(10.3,10.3,11.2,13.6)
A_2<-c(11.2,8.5,9.4,6.8)
A_3<-c(0)
A_4<-c(9.8,8.9,12.2,5.6,3.4)

B_1<-c(18.9,14.5,12.9,14.2,9.9)
B_2<-c(11.2,21.3,14.2,15.3,8.2)
B_3<-c(7.6)
B_4<-c(10.3,17.4,19.2)
B_5<-c(3.4,13.5,19.5,18.5,14.6)

```


```{r}
#Estimate from Strata A#
tpmsq <- function(x) {
   result<-length(x)/25
   return(result)
}

t_A1<-18*tpmsq(A_1)*10000
t_A2<-18*tpmsq(A_2)*10000
t_A3<-18*c(0)
t_A4<-18*tpmsq(A_4)*10000

all.plots_A<-c(t_A1,t_A2,t_A3,t_A4)
  
est.t_A<-(t_A1+t_A2+t_A3+t_A4)/4

var.t_A<-(1/4)*(var(all.plots_A))

```

```{r}
#Estimate from Strata B#


BAF<-4

tf <- function(x) {
   result<-1/(3.14*((x/100)/2)^2)
   return(result)
}

T.B1<-42*(BAF*(sum(tf(B_1))))
T.B2<-42*(BAF*(sum(tf(B_2))))
T.B3<-42*(BAF*(sum(tf(B_3))))
T.B4<-42*(BAF*(sum(tf(B_4))))
T.B5<-42*(BAF*(sum(tf(B_5))))
    


all.plots_B<-c(T.B1,T.B2,T.B3,T.B4,T.B5)
  
est.t_B<-mean(all.plots_B)

var.t_B<-(1/5)*(var(all.plots_B))

```


```{r}
estimates<-c(est_tpHA_A,est.tpHA_B)

var.est<-var(estimates)


SE4<-sqrt(var.est/2)

#90 CI for number of  tpHA#

mean(estimates) + c(-1,1)* SE4 * qt(p=.95,df=1)

```

(5) 90% CI for baHA

```{r}
#Estimate from Strata A#
A_trees<-c(10.3,10.3,11.2,13.6,11.2,8.5,9.4,6.8,0,9.8,8.9,12.2,5.6,3.4)

bamsq <- function(x) {
   result<-((((x)/100)/2)^2)*3.14
   return(result)
}

bpHA.A<-(sum(bamsq(A_trees))/(4*25))*10000*.3

#Estimate from Strata B#
bpHA.B<-(BAF*length(B_trees)/5)*.7


estimatesBA<-c(bpHA.A,bpHA.B)

var_estBA<-var(estimatesBA)


SE_BA<-sqrt(var_estBA/2)

#90 CI for bapHA#

mean(estimatesBA) + c(-1,1)* SE_BA * qt(p=.95,df=1)

```

(6) Estimate the total ba in trees larger than 10cm, DBH as well as its standard error.
```{r}
#BA>10cm for strata A#
large_A_trees<-A_trees[A_trees>10]

bamsq <- function(x) {
   result<-((((x)/100)/2)^2)*3.14
   return(result)
}

bpHA_A_large<-(sum(bamsq(large_A_trees))/(4*25))*10000*.3

large_B_trees<-B_trees[B_trees>10]

bpHA_B_large<-(BAF*length(large_B_trees)/5)*.7

estimatesBA_large<-c(bpHA_A_large,bpHA_B_large)

var_estBA_large<-var(estimatesBA_large)


SE_BA_large<-sqrt(var_estBA_large/2)

#90 CI for BA in trees >10cm#

mean(estimatesBA_large) + c(-1,1)* SE_BA_large * qt(p=.95,df=1)

```


(7) Estimate the average diameter of trees in stratum A and, seperately, of trees in stratum B.


No, you can not use the same estimators for each stratum because stratum B trees were selected using an unequal probability sampling method (variable radius plots) in which the larger trees were selected with a preference.

```{r}
#Average diameter in stratum A#

average_diameter_A<-mean(A_trees)

#Average diameter in stratum B#

mean(B_1)

plot.level.ave.diam<-function(x) {
   result<-(BAF*sum(x/(((x)/200)^2)*3.14))/length(x)
   return(result)
}


plot.level.ave.diam(B_1)




ave.diam.B<-200*(sqrt((bpHA.B/est.tpHA_B)/3.14))
```










