---
title: "FORS 505"
author: "Colin Kirkmire"
date: "April 28, 2016"
output: word_document
---

(4) Compute a 90% CI for the number of TPHA on the whole tract
```{r setup, include=FALSE}

A_1<-c(10.3,10.3,11.2,13.6)
A_2<-c(11.2,8.5,9.4,6.8)
A_3<-c(0)
A_4<-c(9.8,8.9,12.2,5.6,3.4)

B_1<-c(18.9,14.5,12.9,14.2,9.9)
B_2<-c(11.2,21.3,14.2,15.3,8.2)
B_3<-c(7.6)
B_4<-c(10.3,17.4,19.2)
B_5<-c(3.4,13.5,19.5,18.5,14.6)

```


```{r}
#Estimate from Strata A#
total_tree_function <- function(x) {
   result<-18*10000*(length(x)/25)
   return(result)
}

t_hat_A1<-total_tree_function(A_1)
t_hat_A2<-total_tree_function(A_2)
t_hat_A3<-total_tree_function(A_3)
t_hat_A4<-total_tree_function(A_4)

all_plots_A<-c(t_hat_A1,t_hat_A2,t_hat_A3,t_hat_A4)
  
est_tree_total_A<-mean(all_plots_A)

var_tree_total_A<-(1/4)*(var(all_plots_A))

```

```{r}
#Estimate from Strata B#


BAF<-4

tf <- function(x) {
   result<-1/(3.14*((x/100)/2)^2)
   return(result)
}

t_hat_B1<-42*(BAF*(sum(tf(B_1))))
t_hat_B2<-42*(BAF*(sum(tf(B_2))))
t_hat_B3<-42*(BAF*(sum(tf(B_3))))
t_hat_B4<-42*(BAF*(sum(tf(B_4))))
t_hat_B5<-42*(BAF*(sum(tf(B_5))))
    


all_plots_B<-c(t_hat_B1,t_hat_B2,t_hat_B3,t_hat_B4,t_hat_B5)
  
est_tree_total_B<-mean(all_plots_B)

var_tree_total_B<-(1/5)*(var(all_plots_B))

```


```{r}
tpha_estimate<-(sum(est_tree_total_A,est_tree_total_B))/60


SE4<-(sqrt(var_tree_total_A+var_tree_total_B))/60


#90 CI for number of  tpHA#

tpha_estimate + c(-1,1)* SE4 * qt(p=.95,df=1)

```

(5) 90% CI for baHA

```{r}
#Estimate from Strata A#
ba_total_function <- function(x) {
   result<-18*10000*((((((x)/100)/2)^2)*3.14)/25)
   return(result)
}

Tba_hat_A1<-sum(ba_total_function(A_1))
Tba_hat_A2<-sum(ba_total_function(A_2))
Tba_hat_A3<-sum(ba_total_function(A_3))
Tba_hat_A4<-sum(ba_total_function(A_4))

Tba_all_plots_A<-c(Tba_hat_A1,Tba_hat_A2,Tba_hat_A3,Tba_hat_A4)
  
est_ba_total_A<-mean(Tba_all_plots_A)

var_ba_total_A<-(1/4)*(var(Tba_all_plots_A))


#Estimate from Strata B#
ba_total_function <- function(x) {
   result<-BAF*length(x)*42
   return(result)
}

Tba_hat_B1<-ba_total_function(B_1)
Tba_hat_B2<-ba_total_function(B_2)
Tba_hat_B3<-ba_total_function(B_3)    
Tba_hat_B4<-ba_total_function(B_4)
Tba_hat_B5<-ba_total_function(B_5)


Tba_all_plots_B<-c(Tba_hat_B1,Tba_hat_B2,Tba_hat_B3,Tba_hat_B4,Tba_hat_B5)
  
est_ba_total_B<-mean(Tba_all_plots_B)

var_ba_total_B<-(1/5)*(var(all_plots_B))

```

```{r}
bapHA_estimate<-(sum(est_ba_total_A,est_ba_total_B))/60


SE5<-(sqrt(var_ba_total_A+var_ba_total_B))/60


#90 CI for number of  tpHA#

bapHA_estimate + c(-1,1)* SE5 * qt(p=.95,df=1)

```



(6) Estimate the total ba in trees larger than 10cm, DBH as well as its standard error.
```{r}
#BA>10cm for strata A#
large_A_trees<-A_trees[A_trees>10]

bamsq <- function(x) {
   result<-((((x)/100)/2)^2)*3.14
   return(result)
}

bpHA_A_large<-(sum(bamsq(large_A_trees))/(4*25))*10000*.3

large_B_trees<-B_trees[B_trees>10]

bpHA_B_large<-(BAF*length(large_B_trees)/5)*.7

estimatesBA_large<-c(bpHA_A_large,bpHA_B_large)

var_estBA_large<-var(estimatesBA_large)


SE_BA_large<-sqrt(var_estBA_large/2)

#90 CI for BA in trees >10cm#

mean(estimatesBA_large) + c(-1,1)* SE_BA_large * qt(p=.95,df=1)

```


(7) Estimate the average diameter of trees in stratum A and, seperately, of trees in stratum B.


No, you can not use the same estimators for each stratum because stratum B trees were selected using an unequal probability sampling method (variable radius plots) in which the larger trees were selected with a preference.

```{r}
#Average diameter in stratum A#

average_diameter_A<-mean(A_trees)

#Average diameter in stratum B#

mean(B_1)

plot.level.ave.diam<-function(x) {
   result<-(BAF*sum(x/(((x)/200)^2)*3.14))/length(x)
   return(result)
}


plot.level.ave.diam(B_1)




ave.diam.B<-200*(sqrt((bpHA.B/est.tpHA_B)/3.14))
```










